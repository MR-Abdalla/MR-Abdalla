<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" type="image/png" href="logo.png">
  <meta name="description" content="Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªÙ‚Ø¯Ù… Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ Ù…ØªÙ…ÙŠØ² ÙÙŠ Ù…Ø§Ø¯Ø© Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ØŒ ØªØ´Ù…Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ© ÙˆØ´Ø±ÙˆØ­Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©.">
  <meta name="keywords" content="Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ©, ÙÙŠØ²ÙŠØ§Ø¡, Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ©, Ø´Ø±ÙˆØ­Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©, Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡, Ù…Ù†ØµØ© Ù…Ø³ØªØ± Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø³ÙŠØ¯">
  <meta name="author" content="Ù…Ø³ØªØ± Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø³ÙŠØ¯">
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
</head>

 <div class="toast-container" id="toast">
    <div class="toast-text">
     Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø§ÙˆÙ„ 
     ÙŠØ¬Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ùˆ Ø§Ø¯Ø§Ø¤Ù‡ Ù„Ø¹Ø¯Ù… ØªØ¬Ù†Ø¨ ØºÙ„Ù‚ Ø§Ù„Ù…Ù†ØµÙ‡ Ùˆ Ø¹Ø¯Ù… Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª
     <a href="EX/viwo-ex.html" style=" color: rgb(4, 91, 173);">Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø´Ø§Ù…Ù„ Ù…Ù† Ù‡Ù†Ø§</a>
    </div>
    <button class="toast-close" id="closeBtn">âœ•</button>
  </div>


  
   <script>
    const toast = document.getElementById('toast');
    const closeBtn = document.getElementById('closeBtn');
    const showBtn = document.getElementById('showBtn');

    function showToast() {
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 100000);
    }

    closeBtn.addEventListener('click', () => toast.classList.remove('show'));

    window.addEventListener('DOMContentLoaded', showToast);
  </script>

   <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
  <header class="mobile-header">
    <img src="logo.png" alt="Ø§Ù„Ù„ÙˆØ¬Ùˆ">
  </header>
  
        <!-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„Ù‡ÙˆØ§ØªÙ -->
  <button class="mobile-menu-btn" id="mobileMenuBtn">
    <i class="fas fa-bars"></i>
  </button>
  
  <!-- overlay Ù„Ù„Ù‡ÙˆØ§ØªÙ -->
  <div class="overlay" id="overlay"></div>

  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
  <aside class="sidebar" id="sidebar">
    <div class="logo">
      <img src="logo.png" style="width: 40px;" alt="">
      <div class="logo-text">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</div>
    </div>
    
    <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
    <div class="student-info" id="studentInfo" style="display: none;">
      <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage -->
    </div>
    
    <ul class="nav-menu">
      <li class="nav-item">
        <a href="#" class="nav-link active" data-tab="all">
          <i class="fas fa-home"></i>
          <span>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="#" class="nav-link" data-tab="saved">
          <i class="fas fa-bookmark"></i>
          <span>Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø§Øª</span>
          <span class="nav-badge" id="savedCount">0</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="Subscriptions/Subscriptions.html" class="nav-link">
          <i class="fas fa-book-open"></i>
          <span>ÙƒÙˆØ±Ø³Ø§Øª</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="https://mr-abdala.vercel.app/profile/cors.html" class="nav-link">
          <i class="fas fa-video"></i>
          <span>Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ</span>
        </a>
      </li>

      <li class="nav-item">
        <a href="shop/shop.html" class="nav-link">
          <i class="fas fa-store"></i>
          <span>Ø§Ù„Ù…ØªØ¬Ø±</span>
        </a>
      </li>


      <li class="nav-item">
        <a href="https://mr-abdala.vercel.app/profile/" class="nav-link">
          <i class="fas fa-user"></i>
          <span>Ø­Ø³Ø§Ø¨ÙŠ</span>
        </a>
      </li>
    </ul>
  </aside>


    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="main-content">
      <div class="header">
            <header>
        <div class="notif-container">
          <button class="notif-btn" id="notifBtn">
            ğŸ””
            <div class="notif-dot" id="notifDot">0</div>
          </button>
          <div class="notif-box" id="notifBox">
            <div class="notif-header">
              <div class="notif-title">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
              <div class="notif-count" id="notifCount">0 Ø¬Ø¯ÙŠØ¯</div>
            </div>
            <div class="notif-body" id="notifBody">
              <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            <div class="notif-footer">
              <button class="mark-read" id="markReadBtn">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡</button>
            </div>
          </div>
        </div>
      </header>
      

    <!-- Ø¹Ù†ØµØ± ØµÙˆØªÙŠ Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
    <audio id="notificationSound" preload="auto">
      <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
    </audio>

      <h1 class="page-title">
        <span id="pageTitle">Ù…Ø­Ø§Ø¶Ø±Ø§Øª</span>
      </h1>
      
      <div class="search-container" style="display: none;">
        <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙÙŠØ¯ÙŠÙˆ...">
        <i class="fas fa-search search-icon"></i>
      </div>
      
      <div class="user-actions">
        <div class="user-btn user-profile">
          <div class="avatar" id="userAvatar">Ù…</div>
          <span class="name" id="userName">Ù…Ø­Ù…Ø¯</span>
        </div>
      </div>
    </div>
    
   
    
    <div class="videos-grid" id="videosGrid">
      <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
      <div class="loading">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª...</p>

        
      </div>
    </div>
  </main>


      <!-- Ø§Ù„ÙÙˆØªÙˆØ± -->
<footer class="footer">
  <div class="container">
    <!-- Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ -->
    <div class="footer-column">
      <h3>Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§</h3>
      <ul>
        <li><a href="https://www.facebook.com/cphabdallah2"><i class="fab fa-facebook"></i> ÙÙŠØ³Ø¨ÙˆÙƒ</a></li>
        <li><a href="https://www.youtube.com/channel/UCJKXIQVImJWWNATwcciOM1A"><i class="fab fa-youtube"></i> ÙŠÙˆØªÙŠÙˆØ¨</a></li>
      </ul>
    </div>

    <!-- Ø§Ù„ØµÙØ­Ø§Øª -->
    <div class="footer-column">
      <h3>Ø§Ù„ØµÙØ­Ø§Øª</h3>
      <ul>
        <li><a href="">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a href="https://mr-abdala.vercel.app/profile/support/index.html">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</a></li>
      </ul>
    </div>

    <!-- Ø§Ù„Ù„ÙˆØ¬Ùˆ -->
    <div class="footer-column logo">
      <img src="logo.png" alt="Logo">
      <p>Â© 2025 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
      <p>Developed by <a style="color: red; font-weight: 800; font-size: 18px;" href="https://www.facebook.com/profile.php?id=100095386953951">osama</a></p>
    </div>
  </div>
</footer>

<script type="module">
    // ====== Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙƒØªØ¨Ø§Øª Firebase ======
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { 
        getFirestore, 
        collection, 
        getDocs, 
        query, 
        where, 
        orderBy,
        onSnapshot,
        doc,
        getDoc
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    // ==================== Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ (studint-code) ====================
    const studentCheckConfig = {
        apiKey: "AIzaSyCPrQEr2OXfcjPyCRb5uT9KQKZjf5aBDg8",
        authDomain: "studint-code.firebaseapp.com",
        projectId: "studint-code",
        storageBucket: "studint-code.firebasestorage.app",
        messagingSenderId: "736980801683",
        appId: "1:736980801683:web:9e7b1f7caf90b39ded5566",
        measurementId: "G-JV9BQ5KTS9"
    };

    // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (viduo-corss)
    const mainAppConfig = {
        apiKey: "AIzaSyBaezH8j4u0Kmum3poYuFk8LsGtVietnSM",
        authDomain: "viduo-corss.firebaseapp.com",
        projectId: "viduo-corss",
        storageBucket: "viduo-corss.firebasestorage.app",
        messagingSenderId: "485896854659",
        appId: "1:485896854659:web:f0a618235eb4d9e9784fb6",
        measurementId: "G-SVB0WMS9MW"
    };

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ÙŠÙ†
    const studentApp = initializeApp(studentCheckConfig, "studentApp");
    const mainApp = initializeApp(mainAppConfig, "mainApp");

    const studentDB = getFirestore(studentApp);
    const db = getFirestore(mainApp);

    // ==================== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ====================
    async function verifyStudent() {
        const studentData = JSON.parse(localStorage.getItem("studentData"));
        
        if (!studentData || !studentData.studentId) {
            // Ù…ÙÙŠØ´ Ø¨ÙŠØ§Ù†Ø§Øª
            localStorage.removeItem("studentData");
            window.location.href = "create-account.html";
            return;
        }

        try {
            const q = query(
                collection(studentDB, "students"),
                where("studentId", "==", studentData.studentId),
                where("name", "==", studentData.name),
                where("grade", "==", studentData.grade)
            );
            
            const snap = await getDocs(q);

            if (snap.empty) {
                // Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
                localStorage.removeItem("studentData");
                window.location.href = "create-account.html";
            } else {
                console.log("âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø·Ø§Ù„Ø¨:", studentData.name);
                // Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ ÙŠØ¨Ø¯Ø£ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØµØ©
                initPlatform(studentData);
            }
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚:", error);
            localStorage.removeItem("studentData");
            window.location.href = "create-account.html";
        }
    }

    // ==================== ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ù†ØµØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚ ====================
    function initPlatform(studentData) {
        const state = {
            currentTab: 'all',
            currentFilter: 'all',
            savedVideos: JSON.parse(localStorage.getItem('savedVideos')) || [],
            allVideos: [],
            studentData,
            notifications: [],
            readNotifications: JSON.parse(localStorage.getItem('readNotifications')) || []
        };

        // ==== Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ====
        const studentInfo = document.getElementById("studentInfo");
        const userAvatar = document.getElementById("userAvatar");
        const userName = document.getElementById("userName");
        if (studentInfo && studentData) {
            studentInfo.innerHTML = `
                <div class="student-name">${studentData.name}</div>
                <div class="student-details">
                    <div>Ø§Ù„ÙƒÙˆØ¯: ${studentData.studentId}</div>
                    <div>Ø§Ù„ØµÙ: ${studentData.grade}</div>
                </div>
            `;
            userAvatar.textContent = studentData.name.charAt(0);
            userName.textContent = studentData.name;
        }

        // ==== ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØµÙ ====
        async function loadVideos(){
            try {
                const snap = await getDocs(query(
                    collection(db,"videos"),
                    where("grade","==",studentData.grade)
                ));

                const videosGrid = document.getElementById("videosGrid");
                if (snap.empty) {
                    videosGrid.innerHTML = `<div class="empty-state"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p></div>`;
                    return;
                }

                state.allVideos = [];
                snap.forEach(docSnap => {
                    const v = docSnap.data();
                    state.allVideos.push({
                        id: docSnap.id,
                        title: v.title,
                        description: v.description || "",
                        link: v.link,
                        image: v.image || "",
                        category: v.category || "",
                    });
                });

                renderVideos();
            } catch (error) {
                console.error("Error loading videos:", error);
            }
        }

        // ==== Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ====
        function renderVideos() {
            const videosGrid = document.getElementById("videosGrid");
            videosGrid.innerHTML = "";
            state.allVideos.forEach(v => {
                videosGrid.innerHTML += `
                    <div class="video-card">
                        <h3>${v.title}</h3>
                        <p>${v.description}</p>
                    </div>`;
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        const notifQuery = query(collection(db, "notifications"), orderBy("createdAt", "desc"));
        onSnapshot(notifQuery, (snapshot) => {
            const notifs = [];
            snapshot.forEach(doc => {
                const data = doc.data();
                if (data.grade === studentData.grade) notifs.push(data);
            });
            state.notifications = notifs;
            console.log("Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©:", notifs.length);
        });

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚
        loadVideos();
    }

    // ======= Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ° =======
    verifyStudent();

</script>




    <script>
  const sidebar = document.getElementById('sidebar');
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const overlay = document.getElementById('overlay');

  // Ù„Ù…Ø§ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± ÙŠÙØªØ­ Ø§Ù„Ø´Ø±ÙŠØ·
  mobileMenuBtn.addEventListener('click', () => {
    sidebar.classList.toggle('active');
    overlay.classList.toggle('active');
  });

  // Ù„Ù…Ø§ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù€ overlay ÙŠÙ‚ÙÙ„
  overlay.addEventListener('click', () => {
    sidebar.classList.remove('active');
    overlay.classList.remove('active');
  });

  // Ù„Ùˆ Ø§Ù„Ø¹Ø±Ø¶ ÙƒØ¨ÙŠØ± (ÙƒÙ…Ø¨ÙŠÙˆØªØ±) ÙŠÙ‚ÙÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨
  window.addEventListener('resize', () => {
    if (window.innerWidth > 992) {
      sidebar.classList.add('active');
      overlay.classList.remove('active');
    }
  });
</script>



</body>
</html>