<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ - Ù…Ø³ØªØ± Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø³ÙŠØ¯</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="style.css">
</head>
<body>

  <header>
     <img id="logo" src="logo.png" class="profile-avatar">
      <h1 class="app-title">Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ</h1>
  </header>


<div class="main-container">
  <div class="profile-hero">
    <div class="avatar-container">
      <img id="profile-avatar" src="logo.png" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„" class="profile-avatar">
      <div class="avatar-hint">Ø§Ù†Ù‚Ø± Ù„ØªØºÙŠÙŠØ± ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</div>
    </div>
    
    <div class="profile-info">
            <div class="student-id-badge">cod : <span id="badge-id"></span></div>

      <h1>Ø£Ù‡Ù„Ø§Ù‹, <samp id="student-name"></samp></h1>
      <p>Ø£Ø¯Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙˆØ®ØµÙˆØµÙŠØªÙƒØŒ ÙˆØ¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø© <a href="https://wa.me/201229369115">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a> </p>
    </div>

</div>

<div class="menu-slider">
    <a href="" class="active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="personal-info/index.html">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠÙ‡</a>
    <a href="security/index.html">Ø§Ù„Ø­Ù…Ø§ÙŠÙ‡</a>
    <a href="wallet/login.html">Ø§Ù„Ù…Ø­ÙØ¸Ù‡</a>
    <a href="subscription/cors.html">Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ</a>
    <a href="quiz/quiz.html">ÙƒÙˆØ²Ø§ØªÙŠ</a>
</div>


<div class="img">
  <img src="Arabic Typography 2025 - Marwan Galal.jpeg" style="width: 100%; margin: 30px 0;">
</div>


<div class="avatar-modal" id="avatarModal">
  <div class="avatar-modal-content">
    <div class="avatar-modal-header">
      <h2 class="avatar-modal-title">Ø§Ø®ØªØ± ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</h2>
      <button class="close-modal" id="closeModal">&times;</button>
    </div>
    <div class="avatar-grid" id="avatarGrid"></div>
  </div>
</div>

<button class="btn logout-btn" onclick="clearStudentData()">
  ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
</button>


<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCPrQEr2OXfcjPyCRb5uT9KQKZjf5aBDg8",
  authDomain: "studint-code.firebaseapp.com",
  projectId: "studint-code",
  storageBucket: "studint-code.firebasestorage.app",
  messagingSenderId: "736980801683",
  appId: "1:736980801683:web:9e7b1f7caf90b39ded5566",
  measurementId: "G-JV9BQ5KTS9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const avatarImages = [
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-1.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-2.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-3.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-4.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-5.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-6.png",
  "https://res.cloudinary.com/dmeujj1cy/image/upload/logo-profile-7.png"
];

const profileAvatars = document.querySelectorAll('.profile-avatar');
const avatarModal = document.getElementById('avatarModal');
const avatarGrid = document.getElementById('avatarGrid');
const closeModal = document.getElementById('closeModal');

// Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
document.addEventListener('DOMContentLoaded', async ()=>{
  const localData = JSON.parse(localStorage.getItem('studentData')) || {};
  const studentId = localData.studentId;
  if(!studentId) return;

  const studentRef = doc(db,'students',studentId);
  const studentSnap = await getDoc(studentRef);
  if(studentSnap.exists()){
    const data = studentSnap.data();
    document.getElementById('student-name').textContent = data.name || '';
    document.getElementById('badge-id').textContent = studentId;
    if(data.avatar){
      profileAvatars.forEach(img => img.src = data.avatar);
    }
  }
});

// ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„ØµÙˆØ±
profileAvatars.forEach(img => {
  img.addEventListener('click', ()=> avatarModal.classList.add('active'));
});

closeModal.addEventListener('click', ()=> avatarModal.classList.remove('active'));
avatarModal.addEventListener('click', e=>{
  if(e.target === avatarModal) avatarModal.classList.remove('active');
});

// Ø¹Ø±Ø¶ ØµÙˆØ± Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©
function createAvatarOptions(){
  avatarImages.forEach(imgUrl=>{
    const img = document.createElement('img');
    img.src = imgUrl;
    img.className='avatar-option';
    img.addEventListener('click', async ()=>{
      profileAvatars.forEach(i => i.src = imgUrl);
      avatarModal.classList.remove('active');
      const localData = JSON.parse(localStorage.getItem('studentData'))||{};
      localData.avatar = imgUrl;
      localStorage.setItem('studentData', JSON.stringify(localData));
      const studentId = localData.studentId;
      if(studentId){
        const studentRef = doc(db,'students',studentId);
        await updateDoc(studentRef,{avatar: imgUrl});
      }
    });
    avatarGrid.appendChild(img);
  });
}
createAvatarOptions();


window.clearStudentData = function () {
  // Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
  localStorage.removeItem("studentData");

  // ØªØ­ÙˆÙŠÙ„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  window.location.href = "https://mr-abdala.vercel.app/";
};


</script>

<script>
/* ØªØ¹Ø·ÙŠÙ„ ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† */
document.addEventListener("contextmenu", e => e.preventDefault());

/* ØªØ¹Ø·ÙŠÙ„ F12 Ùˆ Ctrl+Shift+I Ùˆ Ctrl+Shift+J Ùˆ Ctrl+U */
document.addEventListener("keydown", function(e) {
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && e.key === "I") ||
    (e.ctrlKey && e.shiftKey && e.key === "J") ||
    (e.ctrlKey && e.key === "U")
  ) {
    e.preventDefault();
  }
});
</script> 
</body>
</html>
